<html mxlns:th="http://www.thymeleaaf.org">

<head th:fragment="registFragmentHead">
    <link rel="stylesheet" href="/styles/board/index.css" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker.min.css"
        integrity="sha512-34s5cpvaNG3BknEWSuOncX28vz97bRI59UnVtEEpFX536A7BtZSJHsDyFoCl8S7Dt2TPzcrCEoHBGeM4SUBDBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker.standalone.min.css"
        integrity="sha512-D5/oUZrMTZE/y4ldsD6UOeuPR4lwjLnfNMWkjC0pffPTCVlqzcHTNvkn3dhL7C0gYifHQJAIrRTASbMvLmpEug=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker3.min.css"
        integrity="sha512-aQb0/doxDGrw/OC7drNaJQkIKFu6eSWnVMAwPN64p6sZKeJ4QCDYL42Rumw2ZtL8DB9f66q4CnLIUnAw28dEbg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker3.standalone.min.css"
        integrity="sha512-t+00JqxGbnKSfg/4We7ulJjd3fGJWsleNNBSXRk9/3417ojFqSmkBfAJ/3+zpTFfGNZyKxPVGwWvaRuGdtpEEA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://code.jquery.com/jquery-3.2.1.js" />
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/js/bootstrap-datepicker.min.js"
        integrity="sha512-LsnSViqQyaXpD4mBBdRYeP6sRwJiJveh2ZIbW41EBrNmKxgr/LFZIiWT6yr+nycvhvauz8c2nYMhrP80YhG7Cw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/locales/bootstrap-datepicker.ko.min.js"
        integrity="sha512-L4qpL1ZotXZLLe8Oo0ZyHrj/SweV7CieswUODAAPN/tnqN3PA1P+4qPu5vIryNor6HQ5o22NujIcAZIfyVXwbQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <div th:fragment="registFragment" class="regist container">
        <form action="/user/regist" method="POST">
            <div class="input-group mb-3">
                <span class="input-group-text">ID<span style="color:red">&nbsp*</span></span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInputGroupId" placeholder="Username"
                        name="user-id" onblur="validateId()">
                    <label for="floatingInputGroupId">아이디</label>
                </div>
                <span class="input-group-text">PW<span style="color:red">&nbsp*</span></span>
                <div class="form-floating">
                    <input type="password" class="form-control" id="floatingInputGroupPw" placeholder="password"
                        name="password" onblur="validatePw()">
                    <label for="floatingInputGroupPw">비밀번호</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Name<span style="color:red">&nbsp*</span></span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInputGroupName" placeholder="name" name="name"
                        onblur="validateName()">
                    <label for="floatingInputGroupName">이름</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Phone<span style="color:red">&nbsp*</span></span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInputGroupPhone" placeholder="phone"
                        name="phone" onblur="validatePhone()">
                    <label for="floatingInputGroupPhone">핸드폰번호</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Address</span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInputGroupAdd" placeholder="address"
                        name="address" onblur="validateAddress()">
                    <label for="floatingInputGroupAdd">집 주소</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">E-MAIL<span style="color:red">&nbsp*</span></span>
                <div class="form-floating">
                    <input type="email" class="form-control" id="floatingInputGroupEmail" placeholder="email"
                        name="email" onblur="validateEmail()">
                    <label for="floatingInputGroupEmail">example@example.com</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Github Address</span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInputGroupGit" placeholder="git-address"
                        name="git-address">
                    <label for="floatingInputGroupGit">(https://github.com/example) or (GitHub ID)</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Gender</span>
                <div class="form-floating">
                    <select class="form-select" aria-label="selectGender" name="gender">
                        <option selected value="0">선택</option>
                        <option value="1">남</option>
                        <option value="2">여</option>
                    </select>
                    <label for="selectGender">성별</label>
                </div>
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Birth</span>
                <div class="form-floating">
                    <input type="text" class="form-control" id="datepicker" placeholder="birth" autocomplete="off"
                        name="birth">
                    <label for="floatingInputGroupBirth">생년월일</label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary" id="submitButton">회원 가입</button>
            <button type="button" class="btn btn-secondary" onclick="window.history.back()">뒤로 가기</button>
            <button type="button" class="btn btn-secondary" id="check">확인</button>
        </form>

        <!-- Modal -->
        <div class="modal fade" id="registModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
            aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="registModalLabel" style="color:red">입력하신 내용을 확인해주세요</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="modalBody" style="font-weight: bold;"></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            $("#datepicker").datepicker({
                format: "yyyy-mm-dd",
                <!-- startDate:"-1d", -->
                endDate: "1d",
                autoclose: true,
                title: "Birth-day",
                language: "ko"
            });
            const registModal = new bootstrap.Modal(document.getElementById('registModal'))

            function validateId() {
                let inputValue = document.getElementById('floatingInputGroupId').value;
                let pattern = /^[0-9a-zA-Z].{2,9}$/;
                if (inputValue != "" && !pattern.test(inputValue)) {
                    document.getElementById("modalBody").innerHTML = "영어 또는 숫자,<br>3글자 ~ 10글자만 입력 가능합니다"
                    registModal.show()
                }
            }

            function validatePw() {
                let inputValue = document.getElementById('floatingInputGroupPw').value;
                let pattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{10,30}$/;
                if (inputValue != "" && !pattern.test(inputValue)) {
                    document.getElementById("modalBody").innerHTML = "대문자, 소문자, 숫자, 특수문자를 모두 포함해야 합니다<br>10자 이상 30글자 이하만 가능합니다"
                    registModal.show()
                }
            }

            function validateName() {
                let inputValue = document.getElementById('floatingInputGroupName').value;
                let pattern = /^[가-힣]{2,10}$|^[a-zA-Z]{4,10}$/;
                if (inputValue != "" && !pattern.test(inputValue)) {
                    document.getElementById("modalBody").innerHTML = "한글 최소 2 ~ 최대 10자<br>영어 최소 4 ~ 최대 20자만 가능합니다"
                    registModal.show()
                }
            }

            function validatePhone() {
                let inputValue = document.getElementById('floatingInputGroupPhone').value;
                let pattern1 = /^[0-9]{10,11}$/;
                let pattern2 = /^(\d{3}-?\d{3,4}-?\d{4})$/;
                console.log(inputValue)
                if (inputValue.includes("-")) {
                    if (inputValue != "" && !pattern2.test(inputValue)) {
                        document.getElementById("modalBody").innerHTML = "총 12~13자만 입력가능합니다"
                        registModal.show()
                    }
                } else {
                    if (inputValue != "" && !pattern1.test(inputValue)) {
                        document.getElementById("modalBody").innerHTML = "숫자 10~11자만 입력가능합니다"
                        registModal.show()
                    }
                }
            }

            function validateAddress() {
                let inputValue = document.getElementById('floatingInputGroupAdd').value;
                let pattern = /^.{5,100}$/;
                if (inputValue != "" && !pattern.test(inputValue)) {
                    document.getElementById("modalBody").innerHTML = "최소 5 ~ 최대 100자만 가능합니다"
                    registModal.show()
                }
            }

            function validateEmail() {
                let inputValue = document.getElementById('floatingInputGroupEmail').value;
                let pattern = /^[^\s@]+@.*\.(com|org|co\.kr|net)$/;
                if (inputValue != "" && !pattern.test(inputValue)) {
                    document.getElementById("modalBody").innerHTML = "@가 포함되어야 합니다<br>.com .org .co.kr .net 으로 끝나야만 합니다"
                    registModal.show()
                }
            }

            document.getElementById('submitButton').addEventListener("click", () => {
                // 깃허브 주소 추가
                let gitValue = document.getElementById('floatingInputGroupGit').value;
                console.log(gitValue)
                if (gitValue != "" && gitValue.indexOf("/") === -1) {
                    gitValue = "https://github.com/" + gitValue;
                    document.getElementById('floatingInputGroupGit').value = gitValue;
                }
                                
                //폰번호 하이픈 추가
                let phoneValue = document.getElementById('floatingInputGroupPhone').value;
                if (phoneValue.length === 10) {
                    phoneValue = `${phoneValue.slice(0, 3)}-${phoneValue.slice(3, 6)}-${phoneValue.slice(6)}`;
                    document.getElementById('floatingInputGroupPhone').value = phoneValue
                    console.log(document.getElementById('floatingInputGroupPhone').value)
                } else if (phoneValue.length === 11) {
                    phoneValue = `${phoneValue.slice(0, 3)}-${phoneValue.slice(3, 7)}-${phoneValue.slice(7)}`;
                    document.getElementById('floatingInputGroupPhone').value = phoneValue
                    console.log(document.getElementById('floatingInputGroupPhone').value)
                }
            })

            document.getElementById('check').addEventListener("click", () => {
                // 깃허브 주소 추가
                let gitValue = document.getElementById('floatingInputGroupGit').value;
                console.log(gitValue)
                if (gitValue != "" && gitValue.indexOf("/") === -1) {
                    gitValue = "https://github.com/" + gitValue;
                    document.getElementById('floatingInputGroupGit').value = gitValue;
                    console.log(gitValue)
                }
                                
                //폰번호 하이픈 추가
                let phoneValue = document.getElementById('floatingInputGroupPhone').value;
                if (phoneValue.length === 10) {
                    phoneValue = `${phoneValue.slice(0, 3)}-${phoneValue.slice(3, 6)}-${phoneValue.slice(6)}`;
                    document.getElementById('floatingInputGroupPhone').value = phoneValue
                    console.log(document.getElementById('floatingInputGroupPhone').value)
                } else if (phoneValue.length === 11) {
                    phoneValue = `${phoneValue.slice(0, 3)}-${phoneValue.slice(3, 7)}-${phoneValue.slice(7)}`;
                    document.getElementById('floatingInputGroupPhone').value = phoneValue
                    console.log(document.getElementById('floatingInputGroupPhone').value)
                }
            })
        </script>
    </div>
</body>

</html>