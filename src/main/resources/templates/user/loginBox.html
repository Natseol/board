<html lang="ko" mxlns:th="http://www.thymeleaaf.org">

<body>
    <div th:fragment="loginFragment">

        <div class="d-flex">
            <form action="/user/login" method="POST">
                <div class="input-group input-group-sm">
                    <div class="d-flex" id="loginInput">
                        <input type="text" class="form-control" id="floatingInputId" placeholder="아이디" name="user-id">
                        <input type="password" class="form-control" id="floatingInputPw" placeholder="비밀번호"
                            name="password">

                    </div>
                    <div th:if="${session.userName != null}">
                        [[${session.userName}]]님 어서오세요&nbsp
                    </div>
                    <button type="submit" class="btn btn-primary" id="loginButton">접속</button>
                </div>
                <div>

                </div>
            </form>
        </div>
        <script>
            let userId = "[[${session.userId}]]"
            const loginButton = document.getElementById("loginButton")
            console.log("userId: " + userId);
            if (userId != "") {
                loginButton.innerText = "로그아웃";
                loginButton.type = "button";
                loginButton.onclick = function () {
                    location.href = '/user/logout';
                };
                loginButton.classList.remove("btn-warning");
                loginButton.classList.add("btn-danger");
                document.getElementById("loginInput").outerHTML = "";                
            } else {
                const modal = new bootstrap.Modal(document.getElementById('myModal'))
                if ("[[${requestErrorFlash}]]" == "회원가입 실패") {
                    document.getElementById("modalBody").innerHTML="아이디 또는 비밀번호가 맞지 않습니다"                    ;
                    modal.show();
                }
            }
        </script>
    </div>
</body>

</html>