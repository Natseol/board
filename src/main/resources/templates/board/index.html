<html mxlns:th="http://www.thymeleaaf.org">

<head th:fragment="boardFragmentHead">
    <link rel="stylesheet" href="/styles/board/index.css" />
</head>

<body>
    <div th:fragment="boardFragment" class="board container">
        <form action="/add" method="POST" id="writeForm">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="floatingInput" placeholder="title" name="title">
                <label for="floatingInput">title</label>
            </div>

            <div class="form-floating mb-3">
                <textarea class="form-control" placeholder="content" id="floatingTextarea" name="content"></textarea>
                <label for="floatingTextarea">content</label>
            </div>

            <button type="submit" class="btn btn-primary" id="writeButton">글 작성</button>
        </form>
        <hr>
        <div>
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">No</th>
                        <th scope="col">제목</th>
                        <th scope="col">작성자</th>
                        <th scope="col">작성일</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item, itemStat:${list}" th:object="${item}">
                        <th scope="row" th:text="*{id}"></th>
                        <td th:text="*{title}"></td>
                        <td th:text="${boardUserList.get(itemStat.index)}"></td>
                        <td th:text="*{createdAt}"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <script>
            function writeFromDisplay() {
                if ("[[${session.userId}]]" != "") {
                    document.getElementById("writeForm").style = "display:block;"
                }
            }
            writeFromDisplay();

            document.getElementById("writeButton").onclick = (e) => {
                const inputTitle = document.getElementById("floatingInput");
                const inputContent = document.getElementById("floatingTextarea");
                const writeModal = new bootstrap.Modal(document.getElementById('myModal'))
                if ("[[${session.userId}]]" == "") {
                    document.getElementById("modalBody").innerHTML = "로그인 후 글작성이 가능합니다"
                    writeModal.show();
                    e.preventDefault();
                } else if (inputTitle.value == "" || inputContent.value == "") {
                    document.getElementById("modalBody").innerHTML = "제목과 내용을 모두 작성해야 합니다"
                    writeModal.show();
                    e.preventDefault();
                }
            }
        </script>
    </div>
</body>

</html>